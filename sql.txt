CREATE TABLE HOADON
(
	MAHD NUMBER GENERATED ALWAYS as IDENTITY(START with 1 INCREMENT by 1),
	TENKM VARCHAR2(50),
	NGAYTAO DATE,
	TONGTIEN NUMBER,
	PHAITRA NUMBER,
	KHACHDUA NUMBER,
	TRALAI NUMBER,
  primary key(MAHD)
)

CREATE TABLE CTHOADON
(
	MAHD NUMBER,
	MADOUONG CHAR(5)
)

ALTER TABLE khuyenmai
ADD CONSTRAINT tenkm_unique UNIQUE (TENKM);

ALTER TABLE HOADON
ADD CONSTRAINT FK_HOADON_MAKM FOREIGN KEY (TENKM) REFERENCES KHUYENMAI(TENKM);

ALTER TABLE CTHOADON
ADD CONSTRAINT FK_CTHOADON_MAHD FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD);

ALTER TABLE CTHOADON
ADD CONSTRAINT FK_CTHOADON_MADOUONG FOREIGN KEY (MADOUONG) REFERENCES DOUONG(MADOUONG);

CREATE FUNCTION FINDHDBYDATE(dateas IN DATE)
return number
IS temp_date number;
BEGIN
	SELECT MAHD INTO temp_date 
	FROM HOADON
	WHERE HOADON.NGAYTAO = date;
	RETURN temp_date;
END;
